<html>
  <head>
    <link rel="stylesheet" href="../../css/spectre.min.css">
  </head>
  <body>

    <p>The METAR/TAF information is obtained from <a href="https://account.avwx.rest/">AVWX</a>. You need an account and generate an API token. The "Hobby" plan - which is free - is sufficient.</p>
    <p>
      <label class="form-label" for="AVWXtoken">AVWX API Token:</label>
      <input class="form-input" type="text" id="AVWXtoken" placeholder="Your personal AVWX API Token" />
    </p>
    <p>
      <button id="upload" class="btn btn-primary">Upload</button>
    </p>

    <script src="../../core/lib/customize.js"></script>
    <script>
      var settings = {};

      function onInit(device) {
        Util.readStorageJSON('avwx.json', currentSettings => {
          settings = currentSettings;
          if ('AVWXtoken' in settings)
            document.getElementById('AVWXtoken').value = settings.AVWXtoken;
        });
      }

      document.getElementById("upload").addEventListener("click", function() {
        settings.AVWXtoken = document.getElementById('AVWXtoken').value;
        sendCustomizedApp({
          storage:[
            { name: "avwx.json", content: JSON.stringify(settings) },
          ]
        });
      });
    </script>

  </body>
</html>
